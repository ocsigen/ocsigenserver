<html><head><title> Configuration file </title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="https://ocsigen.org/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script type="text/javascript" src="https://ocsigen.org/js/client.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js">
//<![CDATA[

//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js">
//<![CDATA[

//]]>
</script></head><body class="config ocsigenserver"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href=".././../../" class="ocsimore_phrasing_link"><img src=".././../../img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Server</p><div class="mainmenu"><p class="mainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a></p><p class="mainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a></p><p><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a></p><p><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a></p><p><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a></p><p><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a></p><p><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a></p></div><form id="googlesearch" action="https://google.com/search"><input name="q" id="gsearch-box" placeholder="Search using Google"/><label for="gsearch-box"><img src="/img/search.svg" alt="" id="gsearch-icon"/></label><input type="submit" id="gsearch-submit" onclick="document.getElementById('gsearch-box').value += ' site:ocsigen.org';"/></form><aside class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-project"><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-toolkit/" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsipersist/" class="ocsimore_phrasing_link">Ocsipersist</a>
</li><li class="drawermainmenu-project"><a href=".././../../html_of_wiki/" class="ocsimore_phrasing_link">html_of_wiki</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsimore/" class="ocsimore_phrasing_link">Ocsimore (<em>deprecated</em>)</a>
</li><li class="drawermainmenu-page"><a href=".././../../projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href=".././../../papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href=".././../../credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href=".././../../contributing" class="ocsimore_phrasing_link">Contributing</a>
</li><li class="drawermainmenu-page"><a href=".././../../blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href=".././../../install" class="ocsimore_phrasing_link">Installation</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><nav class="how-doctree"><h1>Ocsigen server</h1><h2>Usage</h2><h3><a href="quickstart" class="ocsimore_phrasing_link">Quick start</a></h3><h3><a href="launching" class="ocsimore_phrasing_link">Launching the server</a></h3><h3><a href="config" class="ocsimore_phrasing_link">Configuration file</a></h3><h3><a href="staticlink" class="ocsimore_phrasing_link">Using as a library</a></h3><h2>Extensions</h2><h3><a href="staticmod" class="ocsimore_phrasing_link">Staticmod</a></h3><h3><a href="eliom" class="ocsimore_phrasing_link">Eliom</a></h3><h3><a href="extendconfiguration" class="ocsimore_phrasing_link">Extendconfiguration</a></h3><h3><a href="accesscontrol" class="ocsimore_phrasing_link">Accesscontrol</a></h3><h3><a href="authbasic" class="ocsimore_phrasing_link">Authbasic</a></h3><h3><a href="cgimod" class="ocsimore_phrasing_link">CGImod</a></h3><h3><a href="deflatemod" class="ocsimore_phrasing_link">Deflatemod</a></h3><h3><a href="redirectmod" class="ocsimore_phrasing_link">Redirectmod</a></h3><h3><a href="revproxy" class="ocsimore_phrasing_link">Revproxy</a></h3><h3><a href="rewritemod" class="ocsimore_phrasing_link">Rewritemod</a></h3><h3><a href="outputfilter" class="ocsimore_phrasing_link">Outputfilter</a></h3><h3><a href="userconf" class="ocsimore_phrasing_link">Userconf</a></h3><h3><a href="comet" class="ocsimore_phrasing_link">Comet</a></h3><h3><a href="cors" class="ocsimore_phrasing_link">CORS</a></h3><h2>Developer documentation</h2><h3><a href="extend" class="ocsimore_phrasing_link">Writing an extension</a></h3><h3><a href="libraries" class="ocsimore_phrasing_link">Libraries</a></h3><h1>Ocsigen server - API reference</h1><h2>Extensions</h2><h3><a href=".././api/Staticmod" class="ocsimore_phrasing_link">Staticmod</a></h3><h3><a href=".././api/Extendconfiguration" class="ocsimore_phrasing_link">Extendconfiguration</a></h3><h3><a href=".././api/Accesscontrol" class="ocsimore_phrasing_link">Accesscontrol</a></h3><h3><a href=".././api/Authbasic" class="ocsimore_phrasing_link">Authbasic</a></h3><h3><a href=".././api/CGImod" class="ocsimore_phrasing_link">CGImod</a></h3><h3><a href=".././api/Deflatemod" class="ocsimore_phrasing_link">Deflatemod</a></h3><h3><a href=".././api/Redirectmod" class="ocsimore_phrasing_link">Redirectmod</a></h3><h3><a href=".././api/Revproxy" class="ocsimore_phrasing_link">Revproxy</a></h3><h3><a href=".././api/Rewritemod" class="ocsimore_phrasing_link">Rewritemod</a></h3><h3><a href=".././api/Outputfilter" class="ocsimore_phrasing_link">Outputfilter</a></h3><h3><a href=".././api/Userconf" class="ocsimore_phrasing_link">Userconf</a></h3><h3><a href=".././api/Comet" class="ocsimore_phrasing_link">Comet</a></h3><h3><a href=".././api/CORS" class="ocsimore_phrasing_link">CORS</a></h3><h2>Persistent data, writing in the logs, configuration file extension, polymorphic tables</h2><h3><a href=".././api/Ocsigen_lib" class="ocsimore_phrasing_link">Ocsigen_lib</a></h3><h3><a href=".././api/Ocsigen_messages" class="ocsimore_phrasing_link">Ocsigen_messages</a></h3><h3><a href=".././api/Ocsigen_parseconfig" class="ocsimore_phrasing_link">Ocsigen_parseconfig</a></h3><h3><a href=".././api/Polytables" class="ocsimore_phrasing_link">Polytables</a></h3><h3><a href=".././api/Ocsigen_cache" class="ocsimore_phrasing_link">Ocsigen_cache</a></h3><h3><a href=".././api/Ocsipersist" class="ocsimore_phrasing_link">Ocsipersist</a></h3><h3><a href=".././api/Ocsigen_config" class="ocsimore_phrasing_link">Ocsigen_config</a></h3><h2>Extending Ocsigen Server</h2><h3><a href=".././api/Ocsigen_extensions" class="ocsimore_phrasing_link">Ocsigen_extensions</a></h3><h3><a href=".././api/Ocsigen_local_files" class="ocsimore_phrasing_link">Ocsigen_local_files</a></h3><h3><a href=".././api/Ocsigen_headers" class="ocsimore_phrasing_link">Ocsigen_headers</a></h3><h3><a href=".././api/Ocsigen_senders" class="ocsimore_phrasing_link">Ocsigen_senders</a></h3><h3><a href=".././api/Ocsigen_http_frame" class="ocsimore_phrasing_link">Ocsigen_http_frame</a></h3><h3><a href=".././api/Ocsigen_http_client" class="ocsimore_phrasing_link">Ocsigen_http_client</a></h3><h3><a href=".././api/Ocsigen_http_com" class="ocsimore_phrasing_link">Ocsigen_http_com</a></h3><h3><a href=".././api/Ocsigen_stream" class="ocsimore_phrasing_link">Ocsigen_stream</a></h3><h3><a href=".././api/Ocsigen_comet" class="ocsimore_phrasing_link">Ocsigen_comet</a></h3><h2>Indexes</h2><h3> <span><a href=".././api/index_types">Index of types</a></span></h3><h3> <span><a href=".././api/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a href=".././api/index_values">Index of values</a></span></h3><h3> <span><a href=".././api/index_methods">Index of class methods</a></span></h3><h3> <span><a href=".././api/index_classes">Index of classes</a></span></h3><h3> <span><a href=".././api/index_modules">Index of modules</a></span></h3><h3> <span><a href=".././api/index_module_types">Index of module types</a></span></h3></nav></nav></aside></div><p class="reasonwarning">Warning: Reason support is experimental.
We are looking for beta-tester and contributors.
</p><button id="reason">Switch to </button><div class="twocols"><nav class="leftcol">Version <select class="how-versions" onchange="location = this.value;"><option value=".././../dev/manual/config" selected="selected">dev</option><option value=".././../2.9/manual/config">2.9</option><option value=".././../2.8/manual/config">2.8</option><option value=".././../2.7/manual/config">2.7</option><option value=".././../2.6/manual/config">2.6</option><option value=".././../2.5/manual/config">2.5</option><option value=".././../2.3/manual/config">2.3</option><option value=".././../2.2/manual/config">2.2</option><option value=".././../2.1/manual/config">2.1</option><option value=".././../1.3.4/manual/config">1.3.4</option><option value=".././../1.2.2/manual/config">1.2.2</option><option value=".././../1.1.0/manual/config">1.1.0</option></select><nav class="how-doctree"><h1>Ocsigen server</h1><h2>Usage</h2><h3><a href="quickstart" class="ocsimore_phrasing_link">Quick start</a></h3><h3><a href="launching" class="ocsimore_phrasing_link">Launching the server</a></h3><h3><a href="config" class="ocsimore_phrasing_link">Configuration file</a></h3><h3><a href="staticlink" class="ocsimore_phrasing_link">Using as a library</a></h3><h2>Extensions</h2><h3><a href="staticmod" class="ocsimore_phrasing_link">Staticmod</a></h3><h3><a href="eliom" class="ocsimore_phrasing_link">Eliom</a></h3><h3><a href="extendconfiguration" class="ocsimore_phrasing_link">Extendconfiguration</a></h3><h3><a href="accesscontrol" class="ocsimore_phrasing_link">Accesscontrol</a></h3><h3><a href="authbasic" class="ocsimore_phrasing_link">Authbasic</a></h3><h3><a href="cgimod" class="ocsimore_phrasing_link">CGImod</a></h3><h3><a href="deflatemod" class="ocsimore_phrasing_link">Deflatemod</a></h3><h3><a href="redirectmod" class="ocsimore_phrasing_link">Redirectmod</a></h3><h3><a href="revproxy" class="ocsimore_phrasing_link">Revproxy</a></h3><h3><a href="rewritemod" class="ocsimore_phrasing_link">Rewritemod</a></h3><h3><a href="outputfilter" class="ocsimore_phrasing_link">Outputfilter</a></h3><h3><a href="userconf" class="ocsimore_phrasing_link">Userconf</a></h3><h3><a href="comet" class="ocsimore_phrasing_link">Comet</a></h3><h3><a href="cors" class="ocsimore_phrasing_link">CORS</a></h3><h2>Developer documentation</h2><h3><a href="extend" class="ocsimore_phrasing_link">Writing an extension</a></h3><h3><a href="libraries" class="ocsimore_phrasing_link">Libraries</a></h3><h1>Ocsigen server - API reference</h1><h2>Extensions</h2><h3><a href=".././api/Staticmod" class="ocsimore_phrasing_link">Staticmod</a></h3><h3><a href=".././api/Extendconfiguration" class="ocsimore_phrasing_link">Extendconfiguration</a></h3><h3><a href=".././api/Accesscontrol" class="ocsimore_phrasing_link">Accesscontrol</a></h3><h3><a href=".././api/Authbasic" class="ocsimore_phrasing_link">Authbasic</a></h3><h3><a href=".././api/CGImod" class="ocsimore_phrasing_link">CGImod</a></h3><h3><a href=".././api/Deflatemod" class="ocsimore_phrasing_link">Deflatemod</a></h3><h3><a href=".././api/Redirectmod" class="ocsimore_phrasing_link">Redirectmod</a></h3><h3><a href=".././api/Revproxy" class="ocsimore_phrasing_link">Revproxy</a></h3><h3><a href=".././api/Rewritemod" class="ocsimore_phrasing_link">Rewritemod</a></h3><h3><a href=".././api/Outputfilter" class="ocsimore_phrasing_link">Outputfilter</a></h3><h3><a href=".././api/Userconf" class="ocsimore_phrasing_link">Userconf</a></h3><h3><a href=".././api/Comet" class="ocsimore_phrasing_link">Comet</a></h3><h3><a href=".././api/CORS" class="ocsimore_phrasing_link">CORS</a></h3><h2>Persistent data, writing in the logs, configuration file extension, polymorphic tables</h2><h3><a href=".././api/Ocsigen_lib" class="ocsimore_phrasing_link">Ocsigen_lib</a></h3><h3><a href=".././api/Ocsigen_messages" class="ocsimore_phrasing_link">Ocsigen_messages</a></h3><h3><a href=".././api/Ocsigen_parseconfig" class="ocsimore_phrasing_link">Ocsigen_parseconfig</a></h3><h3><a href=".././api/Polytables" class="ocsimore_phrasing_link">Polytables</a></h3><h3><a href=".././api/Ocsigen_cache" class="ocsimore_phrasing_link">Ocsigen_cache</a></h3><h3><a href=".././api/Ocsipersist" class="ocsimore_phrasing_link">Ocsipersist</a></h3><h3><a href=".././api/Ocsigen_config" class="ocsimore_phrasing_link">Ocsigen_config</a></h3><h2>Extending Ocsigen Server</h2><h3><a href=".././api/Ocsigen_extensions" class="ocsimore_phrasing_link">Ocsigen_extensions</a></h3><h3><a href=".././api/Ocsigen_local_files" class="ocsimore_phrasing_link">Ocsigen_local_files</a></h3><h3><a href=".././api/Ocsigen_headers" class="ocsimore_phrasing_link">Ocsigen_headers</a></h3><h3><a href=".././api/Ocsigen_senders" class="ocsimore_phrasing_link">Ocsigen_senders</a></h3><h3><a href=".././api/Ocsigen_http_frame" class="ocsimore_phrasing_link">Ocsigen_http_frame</a></h3><h3><a href=".././api/Ocsigen_http_client" class="ocsimore_phrasing_link">Ocsigen_http_client</a></h3><h3><a href=".././api/Ocsigen_http_com" class="ocsimore_phrasing_link">Ocsigen_http_com</a></h3><h3><a href=".././api/Ocsigen_stream" class="ocsimore_phrasing_link">Ocsigen_stream</a></h3><h3><a href=".././api/Ocsigen_comet" class="ocsimore_phrasing_link">Ocsigen_comet</a></h3><h2>Indexes</h2><h3> <span><a href=".././api/index_types">Index of types</a></span></h3><h3> <span><a href=".././api/index_exceptions">Index of exceptions</a></span></h3><h3> <span><a href=".././api/index_values">Index of values</a></span></h3><h3> <span><a href=".././api/index_methods">Index of class methods</a></span></h3><h3> <span><a href=".././api/index_classes">Index of classes</a></span></h3><h3> <span><a href=".././api/index_modules">Index of modules</a></span></h3><h3> <span><a href=".././api/index_module_types">Index of module types</a></span></h3></nav></nav><article class="rightcol"><header><h1> Configuration file </h1><div id="overview" class="ocsimore_outline"></div><script>
//<![CDATA[
window.addEventListener("load", function(){ outline([0,-515484383,0,0,[0,"nav",[0,"aside",0]],"overview",1]); }, false); 
//]]>
</script></header><p>The main configuration file is usually named
<span class="teletype">/etc/ocsigenserver/ocsigenserver.conf</span>. It contains the port(s) on
which you want to run the server (usually 80), the protocol to use
(HTTP or HTTPS), the location of log files, many settings for the
server, the extensions to be loaded, the OCaml libraries you need for
your Web sites, the configuration of each Web site, etc. One default
configuration file should be provided by your distribution.
</p><h3>Basic layout of the configuration file</h3><p>The configuration file is an XML file. Its layout is the following:
</p><pre>&lt;ocsigen&gt;

  &lt;server&gt;

    &lt;!-- General setting --&gt;
    &lt;port&gt;80&lt;/port&gt;

    &lt;logdir&gt;...&lt;/logdir&gt;
    &lt;datadir&gt;...&lt;/datadir&gt;
    &lt;commandpipe&gt;...&lt;/commandpipe&gt;

    &lt;user&gt;...&lt;/user&gt;
    &lt;group&gt;...&lt;/group&gt;


    &lt;!-- Extensions to be loaded: --&gt;
    &lt;extension module=.../&gt;
    &lt;extension module=...&gt;
      &lt;!-- Options for the extension --&gt;
      ...
    &lt;/extension&gt;

    &lt;!-- You can also use Findlib to load an extension and its dependencies: --&gt;
    &lt;findlib path=.../&gt;
    &lt;extension findlib-package=.../&gt;

    &lt;!-- Libraries needed by Web sites: --&gt;
    &lt;require module=.../&gt; &lt;!-- &lt;require is equivalent to &lt;extension&gt; --&gt;
    &lt;require findlib-package=.../&gt;
    &lt;require module=...&gt;
      &lt;!-- Options for the library --&gt;
      ...
    &lt;/require&gt;

    &lt;!-- Libraries needed by Web sites, when you want them to be reloaded
         every times you reload the config files: --&gt;
    &lt;library module=.../&gt;
    &lt;library findlib-package=.../&gt;
    &lt;library module=...&gt;
      &lt;!-- Options for the library --&gt;
      ...
    &lt;/library&gt;

    &lt;!-- Inclusion of all external configuration files matching *.conf
     from this directory (in alphabetical order): --&gt;
    &lt;extconf dir=... /&gt;

    &lt;!-- Virtual hosts configuration: --&gt;
    &lt;host defaulthostname=... hostfilter=...&gt;

      &lt;!-- configuration for the site at the root --&gt;
      ...

      &lt;site path=...&gt;
        &lt;!-- configuration for the first sub-site --&gt;
        &lt;!-- Warning: it was &lt;site dir=...&gt; before 0.99.4 --&gt;
        ...
      &lt;/site&gt;

      &lt;site path=...&gt;
        &lt;!-- configuration for another sub-site --&gt;
        ...
      &lt;/site&gt;
    &lt;/host&gt;

    &lt;host defaulthostname=... hostfilter=...&gt;
      &lt;!-- configuration for the second virtual host --&gt;
      ...
    &lt;/host&gt;

    ...

  &lt;/server&gt;

&lt;/ocsigen&gt;
</pre><p>Here is a simple example:
</p><pre>&lt;ocsigen&gt;
  &lt;server&gt;

    &lt;port&gt;127.0.0.1:80&lt;/port&gt;

    &lt;logdir&gt;/var/log/ocsigenserver&lt;/logdir&gt;
    &lt;datadir&gt;/var/lib/ocsigenserver&lt;/datadir&gt;
    &lt;commandpipe&gt;/var/run/ocsigenserver/command&lt;/commandpipe&gt;

    &lt;user&gt;www-data&lt;/user&gt;
    &lt;group&gt;www-data&lt;/group&gt;

    &lt;charset&gt;utf-8&lt;/charset&gt;

    &lt;extension findlib-package=&quot;ocsigenserver.ext.staticmod&quot;/&gt;

    &lt;extension findlib-package=&quot;ocsigenserver.ext.ocsipersist-sqlite&quot;/&gt;
    &lt;!-- sqlite3.cma will be loaded automatically using findlib --&gt;

    &lt;extension findlib-package=&quot;eliom.server&quot;/&gt;
    &lt;!-- Eliom's dependencies will be loaded automatically using findlib --&gt;

    &lt;extconf dir=&quot;/etc/ocsigenserver/conf.d&quot; /&gt;

    &lt;host charset=&quot;utf-8&quot; hostfilter=&quot;www.mywonderfulwebsite.org&quot;&gt;

      &lt;static dir=&quot;/var/www/ocsigenserver&quot; /&gt;

      &lt;site path=&quot;tuto&quot;&gt;
        &lt;eliom module=&quot;/usr/local/lib/ocaml/tutoeliom/tutoeliom.cmo&quot; /&gt;
        &lt;static dir=&quot;/var/www/tutorial&quot; /&gt;
      &lt;/site&gt;

    &lt;/host&gt;

  &lt;/server&gt;

&lt;/ocsigen&gt;
</pre><p>Here is another example, for use as unprivileged user toto on port 8000.
We use the PostgreSQL (version &gt;= 9.5) backend for ocsipersist. Note that the
ocsipersist-database under the specified name (default: &quot;ocsipersist&quot;) needs to
exist. To create it run <span class="teletype">psql</span> and execute <span class="teletype">CREATE TABLE ocsipersist;</span>.
</p><pre>&lt;ocsigen&gt;
  &lt;server&gt;

    &lt;port&gt;8000&lt;/port&gt;

    &lt;logdir&gt;/home/toto/var/log/ocsigenserver&lt;/logdir&gt;
    &lt;datadir&gt;/home/toto/var/lib/ocsigenserver&lt;/datadir&gt;
    &lt;commandpipe&gt;/home/toto/var/run/ocsigenserver_command&lt;/commandpipe&gt;

    &lt;user&gt;toto&lt;/user&gt;
    &lt;group&gt;toto&lt;/group&gt;

    &lt;charset&gt;utf-8&lt;/charset&gt;

    &lt;extension findlib-package=&quot;ocsigenserver.ext.staticmod&quot;/&gt;

    &lt;extension findlib-package=&quot;ocsigenserver.ext.ocsipersist-pgsql&quot;&gt;
      &lt;database &lt;!-- optional, as each of the following attributes are --&gt;
        port=&quot;3000&quot;
        user=&quot;toto&quot;
        password=&quot;toto's secret&quot;
      /&gt;
    &lt;/extension&gt;
    &lt;!-- pa_pgsql.cma will be loaded automatically using findlib --&gt;

    &lt;extension findlib-package=&quot;ocsigenserver.ext.eliom&quot;/&gt;
    &lt;!-- Eliom's dependencies will be loaded automatically using findlib --&gt;

    &lt;extconf dir=&quot;/home/toto/etc/ocsigenserver/conf.d&quot; /&gt;

    &lt;host&gt;

      &lt;static dir=&quot;/home/toto/var/www/ocsigenserver&quot; /&gt;

      &lt;site path=&quot;tuto&quot;&gt;
        &lt;eliom module=&quot;/usr/local/lib/ocsigenserver/tutoeliom.cmo&quot; /&gt;
        &lt;static dir=&quot;/home/toto/var/www/ocsigenserver/tutorial&quot; /&gt;
        &lt;!-- Module's path coul be relative but static dir must be absolute --&gt;
      &lt;/site&gt;

    &lt;/host&gt;

  &lt;/server&gt;

&lt;/ocsigen&gt;
</pre><h3> Details about settings </h3><h4> <span class="teletype">&lt;port&gt;</span> : port and protocol </h4><p>The port on which the server is listening. You can have several <span class="teletype">&lt;port&gt;</span>lines if you want to listen on several ports.
</p><p><span class="teletype">&lt;port&gt;</span> has one optional attribute called <span class="teletype">protocol</span>. Its value may be either  <span class="teletype">HTTP</span> (default) or <span class="teletype">HTTPS</span> if you want to use HTTPS on that port. The default port is 80 for HTTP, and 443 for HTTPS.
</p><p>You can make the server bind on a specific address:
</p><pre>    &lt;port&gt;127.0.0.1:80&lt;/port&gt;
</pre><p>To make the server listen on all IPv4 interfaces (and only them):
</p><pre>    &lt;port&gt;*:80&lt;/port&gt;
</pre><p>To make the server listen on all IPv6 interfaces (and only them):
</p><pre>    &lt;port&gt;[::]:80&lt;/port&gt;
</pre><p>To make the server listen on all IPv4 and IPv6 interfaces:
</p><pre>   &lt;port&gt;80&lt;/port&gt;
</pre><p><strong>Warning:</strong> with versions &lt; 1.3.1, the two previous variants were equivalent and would make the server listen on all IPv6 interfaces, and on IPv4 interfaces as well depending on the operating system (more specifically, the default value of IPV6_V6ONLY). This OS-dependent behaviour has been fixed in version 1.3.1.
</p><p>You can also make the server bind on a specific IPv6 address (it must be between brackets):
</p><pre>    &lt;port&gt;[2001:660:3001:4002::10]:80&lt;/port&gt;
</pre><p>If you want to use HTTPS, you need to specify a certificate to use, and a private key, as follows:
</p><pre>    &lt;ssl&gt;
       &lt;certificate&gt;path_to/cert.pem&lt;/certificate&gt;
       &lt;privatekey&gt;path_to/privkey.pem&lt;/privatekey&gt;
    &lt;/ssl&gt;
</pre><p>Use the tools provided by openssl to create a 1024-bit private key to use when creating your CA.:
</p><pre>    openssl genrsa -des3 -out privkey.pem 1024
</pre><p>To create a master certificate based on this key, to use when signing other certificates:
</p><pre>    openssl req -new -x509 -days 1001 -key privkey.pem -out cert.pem
</pre><p>If you don't want to be asked for a password at start-up, you can uncrypt the private key (if you consider it is safe ...):
</p><pre>    openssl rsa -in privkey.pem -out privkey-unsec.pem
</pre><h4><span class="teletype">&lt;logdir&gt;</span> : log files directory</h4><p>The directory for log files. Usually <span class="teletype">/var/log/ocsigenserver</span>. Ocsigenserver is using three log files: <span class="teletype">access.log</span> where all requests are logged, <span class="teletype">errors.log</span> for error messages, and <span class="teletype">warnings.log</span> for warnings.
</p><p>Example :
</p><pre>&lt;logdir&gt;/var/log/ocsigenserver&lt;/logdir&gt;
</pre><h4><span class="teletype">&lt;datadir&gt;</span> : directory for server data</h4><p>This directory is used to store data used by the server or extensions (for example persistent data). Usually <span class="teletype">/var/lib/ocsigenserver</span>.
</p><p>Example :
</p><pre>&lt;datadir&gt;/var/lib/ocsigenserver&lt;/datadir&gt;
</pre><h4><span class="teletype">&lt;syslog&gt;</span> : log to syslog</h4><p>Specifies which syslog facility to use, instead of logging to files. This option
is mutually exclusive with &lt;logdir&gt;.
</p><p>Example:
</p><pre>&lt;syslog&gt;Local7&lt;/syslog&gt;
</pre><h4><span class="teletype">&lt;user&gt;</span> and <span class="teletype">&lt;group&gt;</span> : user who runs the server</h4><p>If the server is launched by root, it will change itself the user and group for the process, for security reasons. Create a group and a user for Ocsigenserver or use an existing user of your system (e.g. <span class="teletype">www-data</span>).
</p><p>Example :
</p><pre>&lt;user&gt;www-data&lt;/user&gt;
&lt;group&gt;www-data&lt;/group&gt;
</pre><h4><span class="teletype">&lt;charset&gt;</span> : default charset for pages</h4><p>Example:
</p><pre>&lt;charset&gt;utf-8&lt;/charset&gt;
</pre><h4 id="upload"><span class="teletype">&lt;uploaddir&gt;</span> : directory where files are uploaded <a class="backref" href="#upload">&#182;</a></h4><p>If you want to allow the users to upload files on the server, add this option.
</p><p>Example:
</p><pre>&lt;uploaddir&gt;/var/upload&lt;/uploaddir&gt;
</pre><p>By default, no directory is specified and uploading is forbidden. Note that the server will remove the files after the request has been served. If the service (the script) want to keep the file, it must create a new hard link on the file itself.
</p><p>You can specify the maximum size of uploaded files using <span class="teletype">&lt;maxuploadfilesize&gt;</span>. For example :
</p><pre>&lt;maxuploadfilesize&gt;2MB&lt;/maxuploadfilesize&gt;
</pre><p>The value may be &quot;infinity&quot; or written using SI or binary units, e.g. 10 10B 10kB 10kiB 10MiB 10TB ... (or 10o 10ko ...) (default in bytes
when no unit is specified)
</p><p><em>Warning:</em> the maximum size of files is also limited by <span class="teletype">&lt;maxrequestbodysize&gt;</span>.
</p><p>Starting from Ocsigenserver 1.3, you can redefine the options <span class="teletype">&lt;uploaddir&gt;</span> and <span class="teletype">&lt;maxuploadfilesize&gt;</span> on each host or inside <span class="teletype">&lt;site&gt;</span> tags. The syntax is the same
as above. There are however some limitations; please read carefully the documentation of the module <span><a href=".././manual/extendconfiguration#upload">Extendconfiguration</a></span> before using this functionality.
</p><h4><span class="teletype">&lt;maxrequestbodysize&gt;</span> : maximum size of the body of incoming requests</h4><p>Example:
</p><pre>&lt;maxrequestbodysize&gt;100MB&lt;/maxrequestbodysize&gt;
</pre><p>The value may be &quot;infinity&quot; or written using SI or binary units, e.g. 10 10B 10kB 10kiB 10MiB 10TB ... (or 10o 10ko ...) (default in bytes
when no unit is specified)
</p><h4><span class="teletype">&lt;mimefile&gt;</span> : MIME type file</h4><p>The file associating file name extensions to their MIME type. Example:
</p><pre>&lt;mimefile&gt;/etc/ocsigenserver/mime.types&lt;/mimefile&gt;
</pre><h4><span class="teletype">&lt;debugmode/&gt;</span> : Error messages in pages</h4><p>Use this option for debugging your Web sites. Full error messages will be written in Error 500 pages. Example:
</p><pre>&lt;debugmode/&gt;
</pre><h4><span class="teletype">&lt;usedefaulthostname/&gt;</span> : Do not trust Host HTTP header for absolute links</h4><p><em>(From Ocsigenserver 1.2) </em>Use this option if you do not trust the Host HTTP header for building absolute links, CGI scripts and redirections. The default hostname set in the configuration file will be used instead. (Same as Apache's UseCanonicalName option). Example:
</p><pre>&lt;usedefaulthostname/&gt;
</pre><h4><span class="teletype">&lt;maxconnected&gt;</span> : Maximum number of simultaneous connections</h4><p>Example:
</p><pre>&lt;maxconnected&gt;500&lt;/maxconnected&gt;
</pre><h4><span class="teletype">&lt;timeout&gt;</span> : Timeout for connections</h4><p>Written in seconds. If the client does not say anything during that amount of time, the connection will be closed. Example:
</p><pre>&lt;timeout&gt;20&lt;/timeout&gt;
</pre><h4><span class="teletype">&lt;keepalivetimeout&gt;</span> : Timeout for Keep-Alive</h4><p>Amount of time (in seconds) the server will wait for subsequent requests on a persistent connection. Example:
</p><pre>&lt;keepalivetimeout&gt;10&lt;/keepalivetimeout&gt;
</pre><h4><span class="teletype">&lt;shutdowntimeout&gt;</span> : Timeout for graceful shutdown <em>From version 1.3</em></h4><p>Amount of time (in seconds) the server will wait for current requests to terminate before ending the process, when you use the &quot;graceful shutdown&quot; server command (see below).
</p><pre>&lt;shutdowntimeout&gt;10&lt;/shutdowntimeout&gt;
</pre><p>Other possible value: <span class="teletype">notimeout</span> if you don't want to wait all connections even if it takes time.
</p><h4><span class="teletype">&lt;netbuffersize&gt;</span> : Size of the input buffer</h4><p>Size of the input buffer (sockets). It is also the maximum size of headers and post data. Example:
</p><pre>&lt;netbuffersize&gt;8192B&lt;/netbuffersize&gt;
</pre><h4><span class="teletype">&lt;filebuffersize&gt;</span> : Size of the buffer for sending files</h4><p>Size of the buffer for reading files to send. Example:
</p><pre>&lt;filebuffersize&gt;8192B&lt;/filebuffersize&gt;
</pre><h4><span class="teletype">&lt;minthreads&gt; &lt;maxthreads&gt;</span> : Size of the preemptive thread pool</h4><p>Even if Ocsigenserver is implemented with cooperative threads, web site programmers may want to detach some computation to other preemptive threads. To do that, Ocsigenserver has a pool of preemptive threads running, waiting for computation to do. This options allow to set the size of this pool. Example:
</p><pre>&lt;minthreads&gt;10&lt;/minthreads&gt;
&lt;maxthreads&gt;1000&lt;/maxthreads&gt;
</pre><h4><span class="teletype">&lt;maxdetachedcomputationsqueued&gt;</span> : Size of the queue of waiting detached computations</h4><p>If the pool of preemptive threads is full, new detached computations will wait for one thread to become available. This is the size of the waiting queue. Only integer values allowed here. Example:
</p><pre>&lt;maxdetachedcomputationsqueued&gt;100&lt;/maxdetachedcomputationsqueued&gt;
</pre><h4><span class="teletype">&lt;maxretries&gt;</span> : Maximum number of retries for the same request</h4><p>To prevent looping requests, for example after a rewrite of the request, the number of retries is limited to this number. Example:
</p><pre>&lt;maxretries&gt;10&lt;/maxretries&gt;
</pre><h4><span class="teletype">&lt;commandpipe&gt;</span> : The pipe used to give orders to the server</h4><p>Ocsigenserver is waiting for orders on a pipe. Write the orders on the pipe. This option allows to set the name of the pipe. Example:
</p><pre>&lt;commandpipe&gt;/var/run/ocsigenserver_command&lt;/commandpipe&gt;
</pre><p>Each extension can define its own orders.
</p><p>Predefined orders:
</p><ul><li> <span class="teletype">reload</span>: will reload the configuration file. Extensions will not be reloaded but all other modules will be reloaded (for example Eliom web sites) <em>(see below for more information)</em>.
</li><li> <span class="teletype">gc</span>: will trigger a heap compaction
</li><li> <span class="teletype">shutdown</span>: will shutdown the server when all the current rerquests are fulfilled <em>(see below for more information)</em>
</li><li> <span class="teletype">reopen_logs</span>: will reopen the logs files (see logrotate configuration for an example of use)
</li><li> <span class="teletype">clearcache</span>: will empty all the caches defined by the module <span class="teletype">Ocsigen_cache</span>
</li></ul><h4><span class="teletype">&lt;extconf&gt;</span> : Splitting the configuration file</h4><p>If your configuration is complex, it is recommended to split the configuration file into several files. The following command will include all external configuration files matching <span class="teletype">*.conf</span> from this directory (in alphabetical order):
</p><pre>&lt;extconf dir=&quot;...&quot;/&gt;
</pre><h3>Loading extensions and libraries</h3><h4><span class="teletype">&lt;extension&gt;</span> : Loading extensions and libraries</h4><p>Ocsigenserver does not do anything without some extensions loaded. For example, you need the extension staticmod for serving static pages. Extensions are loaded dynamically when launching the server. Specify the extensions and libraries you want using the tag &lt;extension&gt;.
</p><p>Warning: The order in which extensions are loaded is usually not significant (from 0.99.4) (but if you have dependencies between the modules). Extensions will try to handle requests in the order in which the options are written inside <span class="teletype">&lt;host&gt;</span>.
</p><p>If you want to run a Web site with Eliom, you probably need the extensions Staticmod and Eliom, the first one to generate static pages, the second one for dynamic pages.
</p><p>If you don't have any extension, no page will be generated.
</p><p>Extensions will not be reloaded if you ask the server to reread the configuration file. And they will be loaded only once, even if
you have several times the same extension. For example if you are using <span class="teletype">&lt;extconf&gt;</span> to configure several websites in several configuration files, you can put all the dependencies in each file.
</p><p>Some extensions take parameters between <span class="teletype">&lt;extension&gt;</span> and <span class="teletype">&lt;/extension&gt;</span>
</p><p>Example of use:
</p><pre>&lt;extension module=&quot;/opt/godi/lib/ocaml/site-lib/ocsigenserver/cgimod.cma&quot;/&gt;
&lt;extension module=&quot;/opt/godi/lib/ocaml/site-lib/ocsigenserver/staticmod.cma&quot;/&gt;
</pre><p>(From version 1.0) Extensions can also be loaded using Findlib. If you specify a package which has dependencies, these dependencies will also be loaded, without parameters. Dependencies are always loaded only once, so you can safely load several extensions which have a shared dependency.
</p><p>If you don't want to clutter your installation with a lot of Ocsigen-specific packages, you can put them outside the default search path (for example, something below <span class="teletype">/usr/local/lib/ocsigenserver</span>), and extend the search path in the configuration file. Here, &quot;search path&quot; has the same semantics as in Findlib. For example, you might have the following line in your configuration file if you compiled and installed Ocsigenserver on your own:
</p><pre>&lt;findlib path=&quot;/usr/local/lib/ocsigenserver/METAS&quot;/&gt;
</pre><p>Extensions shipped with Ocsigen Server are available as subpackages of <span class="teletype">ocsigenserver.ext</span> (this package is in an extended search path). For example:
</p><pre>&lt;extension findlib-package=&quot;ocsigenserver.ext.deflatemod&quot;&gt;
</pre><p>This will load deflatemod, and its dependency camlzip (if not already loaded).
</p><h4><span class="teletype">&lt;require&gt;</span> : Loading libraries</h4><p>From version 1.0, <span class="teletype">&lt;require&gt;</span> is a synonymous for <span class="teletype">&lt;extension&gt;</span>.
</p><h4><span class="teletype">&lt;library&gt;</span> : Loading libraries</h4><p>If you want to load other OCaml libraries for your extensions or Website, use <span class="teletype">&lt;extension&gt;</span> if you do not want them to be reloaded each time the configuration file is reread, or <span class="teletype">&lt;library&gt;</span> if you need them to be reloaded every time. Extensions like CGImod or Staticmod or Eliom can not be loaded with <span class="teletype">&lt;library&gt;</span>. Use <span class="teletype">&lt;library&gt;</span> only for the modules you want to be able to reload without shutting down the server.
</p><p>Libraries may take parameters between <span class="teletype">&lt;library&gt;</span> and <span class="teletype">&lt;/library&gt;</span>.
</p><p>Example of use:
</p><pre>&lt;library module=&quot;/opt/godi/lib/ocaml/site-lib/mysite/mylib.cma&quot;/&gt;
</pre><p>As in <span class="teletype">&lt;extension&gt;</span>, you can also use <span class="teletype">findlib-package=</span> instead of <span class="teletype">module=</span>. However, remember that dependencies will always be loaded only once (only the last file of the package itself may be reloaded several times).
</p><h3>Virtual host and site configuration</h3><h4><span class="teletype">&lt;host&gt;</span> : Virtual host setting</h4><p>It is possible to have several virtual hosts on the same server. For example if your server has two host names, you may want to serve different Web sites for each of them. Note that this feature is based on the <span class="teletype">Host:</span> HTTP header, which is not mandatory in HTTP/1.0.
</p><p>The attribute <span class="teletype">defaulthostname</span> is just an information about the hostname, that can be used for example by services to create absolute links. If you want to create virtual hosts for several domain names, use the <span class="teletype">hostfilter</span> attribute to filter on the <span class="teletype">Host</span> HTTP header. You may specify several hostnames, and the optional <span class="teletype">hostfilter</span> field may contain '*' (wildcard). Example:
</p><pre>&lt;host defaulthostname=&quot;www.mysite.com&quot; hostfilter=&quot;www.mysite.com *.org&quot; charset=&quot;utf-8&quot;&gt; ... &lt;/host&gt;
</pre><p>The <span class="teletype">charset</span> attribute is the default charset for your pages. All attributes are optional, but we recommend to set at least <span class="teletype">defaulthostname</span>.
</p><p>If you do not want to send any charset, explicitely: <span class="teletype">charset=&quot;&quot;</span>. In that case, browsers usually use html meta-data (when present).
</p><p><em>Warning:</em> Before version 1.2.0, <span class="teletype">hostfilter</span> was called: <span class="teletype">name</span> (or <span class="teletype">aliases</span>).
</p><p>It is also possible to set the default ports for http and https, and default protocol using <span class="teletype">defaulthttpport</span>, <span class="teletype">defaulthttpsport</span> and <span class="teletype">defaultprotocol=</span>. These arguments may be used by extensions (like Eliom) if they need to create absolute links. Example:
</p><pre>&lt;host defaulthostname=&quot;www.mywebsite.org&quot; hostfilter=&quot;*.org&quot; defaulthttpport=&quot;8080&quot; defaulthttpsport=&quot;4433&quot; defaultprotocol=&quot;https&quot;&gt; ... &lt;/host&gt;
</pre><p>Inside <span class="teletype">&lt;host&gt;</span>, write the configuration for your main (root) site. These options depend on the extensions loaded. See the documentation about the extensions to know what to put here. It is also possible to define here several subsites, using <span class="teletype">&lt;site&gt;</span> (see below).
</p><h4><span class="teletype">&lt;site&gt;</span> : Configuring sub-sites</h4><p>In each virtual host, it is possible to define several sub-sites (in sub-paths) between <span class="teletype">&lt;site&gt;</span> and <span class="teletype">&lt;/site&gt;</span>. <span class="teletype">&lt;site&gt;</span> has an attribute <span class="teletype">dir</span> to set the home directory for the site. You can also set the default charset for the site using the <span class="teletype">charset</span> attribute. The options between <span class="teletype">&lt;site&gt;</span> and <span class="teletype">&lt;/site&gt;</span> are exactly the same as those you can can put between <span class="teletype">&lt;host&gt;</span> and <span class="teletype">&lt;/host&gt;</span>. They depend on the extensions you loaded. It is also possible to define sub-sites inside sub-sites.
</p><p>Example of use:
</p><pre>&lt;site path=&quot;mysite&quot;&gt; ... &lt;/site&gt;
</pre><h3>Reloading the configuration file</h3><p>To reload the modules of the configuration file without stoping the server, write the command <span class="teletype">reload</span> in the server's command pipe (usually <span class="teletype">/var/run/ocsigenserver_command</span>. For example:
</p><pre>echo reload &gt; /var/run/ocsigenserver_command
</pre><p>Form version 1.3, it is possible to give the name of the configuration file as parameter:
</p><pre>echo reload /etc/ocsigenserver/ocsigenserver.conf.2 &gt; /var/run/ocsigenserver_command
</pre><p>Most distributions have a special command to do that automatically
(for the default configuration file), usually:
</p><pre>/etc/init.d/ocsigenserver reload
</pre><p>The configuration file will be reloaded, and the changes will be taken into account if possible. For example it is not possible to change the port numbers without stoping the server for now. Extensions and libraries loaded using <span class="teletype">&lt;extension&gt;</span> will not be reloaded.
</p><h3>Graceful shutdown <em>(From version 1.3)</em></h3><p>To end the server cleanly, use the <span class="teletype">shutdown</span> command, for example:
</p><pre>echo shutdown &gt; /var/run/ocsigenserver_command
</pre><p>No new connection will be accepted, but all current requests will be terminated (with a timeout). Then the server process will end.
</p><p>You can specify the timeout as parameter (in second):
</p><pre>echo shutdown 10 &gt; /var/run/ocsigenserver_command
</pre><p>It means that the server process will end after at most 10 seconds, even if some connexions are still alive. If you do not want any timeout, do:
</p><pre>echo shutdown notimeout &gt; /var/run/ocsigenserver_command
</pre><p>In that case, the server will wait for all the connections to terminate, even if it takes a lot of time.
</p><p>The default timeout value can be set in the configuration file (see <span class="teletype">shutdowntimeout</span> option above).</p></article></div></div></body></html>
